---
sidebar_position: 2
---

import UUIDGenerator from '@site/src/components/UUIDGenerator'

# Getting Started

The **JS13K Online** category challenges developers to create MMO (Massively Multiplayer Online) versions of their games. This experimental category is powered by our hosted version of [PartyServer](https://www.npmjs.com/package/partyserver), Cloudflare's PartyKit-inspired scalable server based on [Cloudflare Workers](https://developers.cloudflare.com/workers/).

## What is JS13K Online?

JS13K Online is a special category in the JS13K competition that focuses on multiplayer games. While the base [JS13K Online protocol](https://js13kgames.com/online) provides the core communication primitives, **Lab13's SDK extends this protocol** with additional conveniences and features to make multiplayer game development easier.

### Lab13 SDK Extensions

The Lab13 SDK builds upon the base JS13K Online protocol and adds:

- **Player ID Management**: Automatic tracking and querying of connected players
- **Enhanced Events**: Rich event system for player connections, disconnections, and state updates
- **Bot Support**: Built-in support for AI players and bot management
- **Protocol Extensions**: Additional message types for common multiplayer scenarios
- **Type Safety**: Full TypeScript support with proper event typing

## Installation

```html
<script type="module">
  import { Lab13Client } from 'https://esm.sh/lab13-sdk'
  import { PartySocket } from 'https://esm.sh/partysocket'

  // Create a PartySocket connection to your room
  const socket = new PartySocket({
    host: 'your-party-server.partykit.dev',
    room: 'my-game-room',
  })

  // Initialize the Lab13 client with the socket
  const client = Lab13Client(socket)
</script>
```

## Your First MMO Game

Let's create a simple multiplayer game where players can move around and see each other:

<div style={{ display: 'flex', justifyContent: 'flex-start', marginBottom: 16 }}>
  <a
    href="https://codesandbox.io/p/sandbox/jmfms6"
    target="_blank"
    style={{
      display: 'inline-flex',
      alignItems: 'center',
      justifyContent: 'center',
      padding: '8px 16px',
      background: '#2563eb',
      color: '#fff',
      borderRadius: '6px',
      textDecoration: 'none',
      fontWeight: 600,
      fontSize: '15px',
      height: '38px',
      lineHeight: 1,
      transition: 'background 0.2s',
    }}
    onMouseOver={(e) => (e.currentTarget.style.background = '#1e40af')}
    onMouseOut={(e) => (e.currentTarget.style.background = '#2563eb')}
  >
    <span>Codesandbox Playground</span>
  </a>
</div>

---

<iframe
  width="640"
  height="400"
  src="https://www.youtube.com/embed/iq8yZbFNuJw"
  title="YouTube video player"
  frameBorder="0"
  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
  allowFullScreen
></iframe>

---

### Build it step-by-step

#### Step 1 — HTML skeleton

```html
<!DOCTYPE html>
<html>
  <head>
    <title>My First MMO</title>
  </head>
  <body>
    <div id="game"></div>
    <div id="status">Connecting...</div>
    <script type="module"></script>
  </body>
</html>
```

#### Step 2 — Add styles

```html
<style>
  #game {
    width: 640px;
    height: 400px;
    border: 1px solid #ccc;
    position: relative;
  }
  .player {
    width: 20px;
    height: 20px;
    background: blue;
    position: absolute;
    border-radius: 50%;
  }
  .me {
    background: red;
  }
</style>
```

#### Step 3 — Initialize the client

```html
<script type="module">
  import { Lab13Client } from 'https://esm.sh/lab13-sdk'
  import { PartySocket } from 'https://esm.sh/partysocket'

  const gameDiv = document.getElementById('game')
  const statusDiv = document.getElementById('status')
  const clientElements = new Map()

  // Create the socket connection
  const socket = new PartySocket({
    host: 'your-party-server.partykit.dev',
    room: 'my-awesome-game-v1',
  })

  // Initialize the Lab13 client
  const client = Lab13Client(socket)

  client.on('player-id-updated', (event) => {
    const myId = event.detail
    statusDiv.textContent = `Connected! My ID: ${myId}. Move with arrow keys.`
    // Initialize player position
    client.sendToAll(`init:${JSON.stringify({ x: 400, y: 300 })}`)
  })
</script>
```

#### Step 4 — Listen for client events

```html
<script type="module">
  client.on('client-connected', (event) => {
    const clientId = event.detail
    console.log('Client connected:', clientId)
  })

  client.on('client-disconnected', (event) => {
    const clientId = event.detail
    console.log('Client disconnected:', clientId)
    const element = clientElements.get(clientId)
    if (element) {
      element.remove()
      clientElements.delete(clientId)
    }
  })

  client.on('client-ids-updated', (event) => {
    const clientIds = event.detail
    console.log('Current clients:', clientIds)
    // Query each client for their state
    clientIds.forEach((id) => {
      client.sendToPlayer(id, 'getState')
    })
  })
</script>
```

#### Step 5 — Handle custom messages

```html
<script type="module">
  socket.addEventListener('message', (event) => {
    const msg = event.data.toString()

    // Handle custom game messages
    if (msg.startsWith('init:')) {
      const state = JSON.parse(msg.slice(5))
      createClientElement(client.playerId(), state)
    } else if (msg.startsWith('move:')) {
      const [clientId, x, y] = msg.slice(5).split(',')
      updateClientPosition(clientId, parseInt(x), parseInt(y))
    } else if (msg === 'getState') {
      // Respond with current state
      const myState = getMyState()
      client.sendToPlayer(client.playerId(), `init:${JSON.stringify(myState)}`)
    }
  })

  function createClientElement(clientId, state) {
    let element = clientElements.get(clientId)
    if (!element) {
      element = document.createElement('div')
      element.className = 'player' + (clientId === client.playerId() ? ' me' : '')
      gameDiv.appendChild(element)
      clientElements.set(clientId, element)
    }
    element.style.left = state.x + 'px'
    element.style.top = state.y + 'px'
  }

  function updateClientPosition(clientId, x, y) {
    const element = clientElements.get(clientId)
    if (element) {
      element.style.left = x + 'px'
      element.style.top = y + 'px'
    }
  }

  function getMyState() {
    // Return current player state
    return { x: 400, y: 300 } // This would be your actual state
  }
</script>
```

#### Step 6 — Handle keyboard input

```html
<script type="module">
  const keys = new Set()
  let moveSpeed = 3
  let myState = { x: 400, y: 300 }

  document.addEventListener('keydown', (e) => {
    keys.add(e.code)
  })

  document.addEventListener('keyup', (e) => {
    keys.delete(e.code)
  })
</script>
```

#### Step 7 — Add the game loop

```html
<script type="module">
  function gameLoop() {
    const myId = client.playerId()
    if (!myId) {
      requestAnimationFrame(gameLoop)
      return
    }

    let dx = 0,
      dy = 0

    if (keys.has('ArrowLeft') || keys.has('KeyA')) dx = -moveSpeed
    if (keys.has('ArrowRight') || keys.has('KeyD')) dx = moveSpeed
    if (keys.has('ArrowUp') || keys.has('KeyW')) dy = -moveSpeed
    if (keys.has('ArrowDown') || keys.has('KeyS')) dy = moveSpeed

    if (dx !== 0 || dy !== 0) {
      const newX = Math.max(0, Math.min(620, myState.x + dx))
      const newY = Math.max(0, Math.min(380, myState.y + dy))
      myState = { x: newX, y: newY }

      // Send movement to all clients
      client.sendToAll(`move:${myId},${newX},${newY}`)

      // Update local display
      updateClientPosition(myId, newX, newY)
    }

    requestAnimationFrame(gameLoop)
  }

  gameLoop()
</script>
```

<details>
  <summary>Full example (copy‑paste)</summary>

```html
<!DOCTYPE html>
<html>
  <head>
    <title>My First MMO</title>
    <style>
      #game {
        width: 640px;
        height: 400px;
        border: 1px solid #ccc;
        position: relative;
      }
      .player {
        width: 20px;
        height: 20px;
        background: blue;
        position: absolute;
        border-radius: 50%;
      }
      .me {
        background: red;
      }
    </style>
  </head>
  <body>
    <div id="game"></div>
    <div id="status">Connecting...</div>

    <script type="module">
      import { Lab13Client } from 'https://esm.sh/lab13-sdk'
      import { PartySocket } from 'https://esm.sh/partysocket'

      const gameDiv = document.getElementById('game')
      const statusDiv = document.getElementById('status')
      const clientElements = new Map()

      const socket = new PartySocket({
        host: 'your-party-server.partykit.dev',
        room: 'my-awesome-game-v1',
      })

      const client = Lab13Client(socket)

      client.on('player-id-updated', (event) => {
        const myId = event.detail
        statusDiv.textContent = `Connected! My ID: ${myId}. Move with arrow keys.`
        client.sendToAll(`init:${JSON.stringify({ x: 400, y: 300 })}`)
      })

      client.on('client-connected', (event) => {
        const clientId = event.detail
        console.log('Client connected:', clientId)
      })

      client.on('client-disconnected', (event) => {
        const clientId = event.detail
        console.log('Client disconnected:', clientId)
        const element = clientElements.get(clientId)
        if (element) {
          element.remove()
          clientElements.delete(clientId)
        }
      })

      client.on('client-ids-updated', (event) => {
        const clientIds = event.detail
        console.log('Current clients:', clientIds)
        clientIds.forEach((id) => {
          client.sendToPlayer(id, 'getState')
        })
      })

      socket.addEventListener('message', (event) => {
        const msg = event.data.toString()

        if (msg.startsWith('init:')) {
          const state = JSON.parse(msg.slice(5))
          createClientElement(client.playerId(), state)
        } else if (msg.startsWith('move:')) {
          const [clientId, x, y] = msg.slice(5).split(',')
          updateClientPosition(clientId, parseInt(x), parseInt(y))
        } else if (msg === 'getState') {
          const myState = getMyState()
          client.sendToPlayer(client.playerId(), `init:${JSON.stringify(myState)}`)
        }
      })

      function createClientElement(clientId, state) {
        let element = clientElements.get(clientId)
        if (!element) {
          element = document.createElement('div')
          element.className = 'player' + (clientId === client.playerId() ? ' me' : '')
          gameDiv.appendChild(element)
          clientElements.set(clientId, element)
        }
        element.style.left = state.x + 'px'
        element.style.top = state.y + 'px'
      }

      function updateClientPosition(clientId, x, y) {
        const element = clientElements.get(clientId)
        if (element) {
          element.style.left = x + 'px'
          element.style.top = y + 'px'
        }
      }

      function getMyState() {
        return myState
      }

      const keys = new Set()
      let moveSpeed = 3
      let myState = { x: 400, y: 300 }

      document.addEventListener('keydown', (e) => {
        keys.add(e.code)
      })

      document.addEventListener('keyup', (e) => {
        keys.delete(e.code)
      })

      function gameLoop() {
        const myId = client.playerId()
        if (!myId) {
          requestAnimationFrame(gameLoop)
          return
        }

        let dx = 0,
          dy = 0

        if (keys.has('ArrowLeft') || keys.has('KeyA')) dx = -moveSpeed
        if (keys.has('ArrowRight') || keys.has('KeyD')) dx = moveSpeed
        if (keys.has('ArrowUp') || keys.has('KeyW')) dy = -moveSpeed
        if (keys.has('ArrowDown') || keys.has('KeyS')) dy = moveSpeed

        if (dx !== 0 || dy !== 0) {
          const newX = Math.max(0, Math.min(620, myState.x + dx))
          const newY = Math.max(0, Math.min(380, myState.y + dy))
          myState = { x: newX, y: newY }

          client.sendToAll(`move:${myId},${newX},${newY}`)
          updateClientPosition(myId, newX, newY)
        }

        requestAnimationFrame(gameLoop)
      }

      gameLoop()
    </script>
  </body>
</html>
```

</details>

## Adding Bot Support

You can easily add monitoring bots to your game:

```js
// Create a monitoring bot client
const botClient = Lab13Client(socket, { bot: true })

// Listen for bot events
client.on('bot-ids-updated', (event) => {
  console.log('Current monitor bots:', event.detail)
})

// Get different client types
const allClients = client.clientIds() // All clients
const players = client.playerIds() // Only players
const bots = client.botIds() // Only bots
```

> **Note**: Per JS13K Online rules, bots can only monitor the game. They cannot interact with or alter game state.

## What's Next?

- Learn about [Game Loop](./game-loop) to understand the connection flow
- Dive into [Game State Management](./tutorials/game-state) for advanced state handling
- Explore [Entity Management](./tutorials/entity-management) for complex multiplayer games
- [Lab13 SDK API Reference](./api-reference)
